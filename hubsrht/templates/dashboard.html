{% extends "layout.html" %}
{% import "event.html" as eventutil with context %}
{% block title %}
<title>{{cfg("sr.ht", "site-name")}} dashboard</title>
{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-4">
    <p>
      Welcome back, {{current_user.canonical_name}}!
      This is the {{cfg("sr.ht", "site-name")}} hub service, which organizes
      and indexes projects and users on the platform.
    </p>
    <div style="margin-bottom: 1rem">
      <a
        href="{{url_for("projects.create_GET")}}"
        class="btn btn-primary btn-block"
      >Create new project {{icon("caret-right")}}</a>
      <a
        href="#"
        class="btn btn-white btn-sm btn-block"
      >Discover projects on {{cfg('sr.ht', 'site-name')}} {{icon("caret-right")}}</a>
      <a
        href="{{url_for("public.getting_started")}}"
        class="btn btn-link btn-sm btn-block"
        >Getting started with {{cfg('sr.ht', 'site-name')}} {{icon("caret-right")}}</a>
    </div>
  </div>
  <div class="col-md-8">
    <div class="row">
      <div class="col-md-12">
        <hr class="d-md-none" />
        <form action="{{url_for("users.projects_GET",
          owner=current_user.canonical_name)}}"
        >
          <input
            name="search"
            type="text"
            placeholder="Search your projects"
            class="form-control" />
          {% if search_error %}
            <div class="invalid-feedback">{{ search_error }}</div>
          {% endif %}
        </form>
        <div class="event-list">
          {% for project in projects %}
          <div class="event">
            <h4>
              {% if project.visibility.value != 'public' %}
              <small class="text-muted pull-right">{{project.visibility.value}}</small>
              {% endif %}
              <a href="{{url_for("projects.summary_GET",
                owner=project.owner.canonical_name,
                project_name=project.name)}}">{{project.name}}</a>
            </h4>
            <p>{{project.description}}</p>
          </div>
          {% endfor %}
        </div>
        <div class="pull-right">
          <a
            href="#"
            class="btn btn-link"
          >More projects&nbsp;{{icon("caret-right")}}</a>
        </div>
        <div class="clearfix"></div>
      </div>
    </div>
    <div class="row" style="margin-top: 1rem">
      <div class="col-md-12">
        <div class="event-list project-events">
          {% for event in events %}
          {{ eventutil.event(event, project=True) }}
          {% endfor %}
        </div>
        <div class="pull-right">
          <a
            href="#"
            class="btn btn-link"
          >More events&nbsp;{{icon("caret-right")}}</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

